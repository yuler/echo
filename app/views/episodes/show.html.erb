<div data-controller="audio-player"
     class="min-h-screen bg-white">

  <!-- Fixed Header with Audio Player -->
  <div class="fixed top-0 left-0 right-0 bg-white/90 backdrop-blur-md border-b border-gray-100 z-50 transition-all duration-300 transform"
       data-audio-player-target="header">
    <div class="max-w-2xl mx-auto px-4 py-3">
      <div class="flex items-center justify-between mb-2">
        <%= link_to episodes_path, class: "text-gray-400 hover:text-gray-900 transition" do %>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
          </svg>
        <% end %>
        <h1 class="text-sm font-medium text-gray-900 truncate max-w-[200px]"><%= @episode[:title] %></h1>
        <div class="w-6"></div> <!-- Spacer -->
      </div>

      <audio data-audio-player-target="audio"
             src="<%= @episode[:audio_url] %>"
             class="w-full h-8"
             controls>
      </audio>
    </div>
  </div>

  <!-- Content Area -->
  <div class="max-w-2xl mx-auto px-4 pt-32 pb-24">
    <div class="space-y-8">
      <% @episode[:content].each_with_index do |sentence, index| %>
        <div class="sentence transition-opacity duration-300"
             data-audio-player-target="sentence"
             data-time="<%= sentence[:time] %>">

          <!-- English Text -->
          <p class="text-xl md:text-2xl text-gray-800 leading-relaxed cursor-pointer hover:text-black transition-colors"
             data-action="click->audio-player#seek"
             data-time="<%= sentence[:time] %>">
             <% sentence[:text].split(' ').each do |word| %>
               <span class="word transition-colors duration-150 rounded px-0.5 -mx-0.5"
                     data-audio-player-target="word"><%= word %></span>
             <% end %>
          </p>

          <!-- Translation -->
          <p class="mt-2 text-base text-gray-500 hidden transition-all duration-300"
             data-audio-player-target="translation">
            <%= sentence[:translation] %>
          </p>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Floating Toggle Button -->
  <button data-action="click->audio-player#toggleTranslation"
          class="fixed bottom-8 right-8 bg-black text-white rounded-full p-3 shadow-lg hover:scale-105 transition-transform duration-200 z-40"
          aria-label="Toggle Translation">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129" />
    </svg>
  </button>
</div>
